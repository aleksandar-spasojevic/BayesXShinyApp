BayesX.design.matrix <- function(x, ...) {
  w <- getOption("warn")
  options(warn = -1)
  tx <- as.integer(as.character(unlist(x)))
  options("warn" = w)
  x <- if(!any(is.na(tx))) tx else as.integer(x)
  levels <- c(84, 108, 136, 277, 286, 321, 65, 76, 98, 125, 126, 148, 158, 216, 255, 257, 263, 270, 301, 80, 67, 101, 105, 129, 161, 175, 196, 218, 226, 245, 251, 262, 271, 103, 90, 107, 113, 140, 192, 239, 100, 135, 155, 159, 215, 149, 142, 168, 191, 151, 152, 197, 205, 150, 185, 203, 473, 480, 481, 482, 176, 478, 474, 476, 477, 470, 99, 169, 475, 471, 472, 469, 465, 117, 119, 123, 139, 468, 467, 466, 460, 458, 462, 132, 173, 459, 461, 453, 455, 454, 457, 227, 306, 326, 328, 167, 194, 208, 438, 441, 446, 437, 442, 436, 452, 448, 445, 234, 235, 269, 258, 281, 312, 325, 172, 195, 228, 434, 428, 430, 435, 439, 443, 444, 433, 266, 267, 283, 287, 295, 320, 343, 354, 368, 163, 222, 232, 423, 422, 420, 421, 426, 429, 431, 243, 264, 293, 317, 329, 337, 347, 355, 360, 373, 383, 384, 392, 397, 404, 407, 160, 179, 198, 220, 229, 390, 402, 398, 409, 414, 415, 418, 417, 419, 424, 425, 250, 256, 294, 314, 330, 338, 358, 374, 389, 385, 153, 178, 201, 223, 236, 246, 386, 412, 393, 394, 400, 406, 405, 413, 408, 416, 268, 297, 308, 344, 342, 369, 377, 141, 162, 182, 181, 221, 231, 378, 396, 387, 395, 399, 401, 403, 260, 265, 284, 315, 331, 349, 365, 351, 364, 120, 130, 188, 184, 213, 224, 237, 353, 376, 381, 382, 380, 379, 391, 240, 242, 279, 304, 335, 346, 334, 345, 121, 131, 180, 189, 193, 219, 352, 367, 357, 366, 372, 375, 210, 249, 282, 323, 324, 319, 332, 118, 134, 170, 156, 166, 165, 190, 348, 350, 356, 361, 209, 225, 230, 274, 310, 292, 296, 305, 316, 137, 138, 110, 128, 146, 336, 322, 341, 313, 177, 186, 206, 273, 276, 290, 278, 275, 291, 112, 93, 106, 115, 124, 122, 143, 303, 333, 340, 339, 300, 309, 302, 307, 289, 157, 183, 207, 244, 254, 88, 83, 89, 82, 97, 102, 127, 280, 299, 311, 318, 261, 272, 285, 288, 238, 247, 147, 154, 217, 211, 47, 72, 79, 81, 70, 77, 87, 104, 111, 259, 214, 233, 199, 202, 95, 133, 171, 38, 52, 66, 62, 63, 69, 78, 86, 164, 91, 174, 145, 92, 109, 45, 54, 56, 51, 59, 64, 68, 73, 96, 116, 71, 114, 85, 94, 41, 40, 50, 53, 57, 60, 49, 58, 61, 74, 75, 29, 32, 36, 42, 44, 48, 43, 55, 22, 26, 28, 27, 34, 39, 31, 37, 16, 21, 23, 25, 30, 17, 20, 18, 19, 14, 8, 12, 7, 10, 6, 5)
  x <- factor(x, levels = levels)
  X <- diag(length(levels))[x, ]
  attr(X, "type") <- "mrf"
  return(X)
}
